# <center> Прогнозирование спроса и выручки в сети кафе
![](https://rossaprimavera.ru/static/files/2af9b969d6ff.jpg)

## <center> Оглавление
1. [Опиcание проекта](#описание-проекта)
2. [Данный проект реализует](#данный-проект-реализует)
3. [Авторы](#авторы)
4. [Выводы](#решение-и-результаты)

## Описание проекта
Логичным завершением полуторагодичной учёбы по специализации Data Science стал дипломный проект. Я решил не брать готовые кейсы, а создать свой: актуальный, жизненный, востребованный и максимально подходящий к реальной бизнес задаче. Понимал, что браться за такое без опыта рискованно, но **так закалялась сталь**.

# Итак
В г.Петрозаводске есть сеть кафе/ресторанов (в настоящее время 5 предприятий), осуществляющих торговлю блюдами и напитками. Всё - собственное производство. Принцип работы заведений - блюда на вынос, позволяющий как брать с собой, так и завтракать(обедать и т.д.) на месте.

**Мной собрана** и реализована в формате **xlsx** (4 файла) база данных за 4 года по всей сети кафе, содержащая следующие сведения:
1. Время открытия
2. Блюдо
3. Количество блюд
4. Группа блюда
5. Тип оплаты
6. Торговое предприятие
7. Сумма со скидкой, р.
8. Сумма без скидки, р.
9. Задержка начала приготовления (средняя)
10. Наценка(%)
11. Себестоимость, р.
12. Себестоимость(%)
**Всего 3260993 строк и 12 столбцов**

**Проблематика**: Данная сеть ресторанов уже использует, возможно, наиболее популярный в России сервис по сопровождению всей деятельности общепита. Помимо прочего данный сервис также делает прогноз по выручке и спросу.

Однако, по мнению владельца сети, имеющийся прогноз далек от идеала и требует совершенствования.

### Данный проект реализует:
* Предобработку набора данных:
  - [cafe_df_preparing.ipynb](./cafe_df_preparing.ipynb)
* Формирование новых признаков
  - [cafe_weather.ipynb](./cafe_weather.ipynb)
  - [preprocessing.ipynb](./preprocessing.ipynb)
* Разведывательный анализ данных и выявление основных закономерностей
  - [cafe_f_engin_EDA.ipynb](./cafe_f_engin_EDA.ipynb)
* Построение нескольких моделей машинного обучения, решающих задачу регрессии, прогнозируя спрос и выручку предприятий
  - [df_ml_cafe.ipynb](./df_ml_cafe.ipynb)
* Анализ результата
  - best_catboost.cmd

## Установка проекта
```
git clone https://github.com/ZlatanSU87/Graduate-work.-Forecast-for-the-cafe-chain
```

## Использование
Вся информация о работе представлена в указанных jupyter-ноутбуках

## Авторы

* [Sergey](https://t.me/IZ20112022)

### Решение и результаты:

Ранее я указал, что данная сеть кафе уже использует прогностическую модель. Не имея возможности посмотреть на решения, используемые в этой модели, я решил сосредоточится на feature engineering, к примеру, сформировав новые признаки, основанные на погодных явлениях, праздниках.

Подготовив данные для обучения, я решил использовать как ML модели, так и эффективный (как казалось) инструмент для временных рядов. Таким образом я решил остановиться на **catboost, lightgbm, xgboost, prophet**. В качестве основных метрик я остановился на **MAE и RMSE**.

**По итогам** обучения моделей  можно сделать **вывод**, что **наилучший результат** показал **catboost**: 

      Model         MAE        RMSE
0  CatBoost   22.310267   30.694928
1  LightGBM   34.754877   48.325902
2   XGBoost   22.719739   31.696479
3   Prophet  268.654126  322.641736

Также следует ометить, что Prophet показал совсем плохие результаты. В целом показатели метрик по моделям ML удовлетворительные, но требуют совершенствования. По результатам оценки важности признаков лучшие результаты (неожиданно) показал **windy** (сформированный погодный признак, означающий наличие сильного ветра). Остальные сильно отстают. Вместе с тем, по результатам EDA лидировал **t_mean**. 

**Результат** можно считать удовлетворительным. Выявленные закономерности, а также просчеты требуют новых экспериментов. Наличие резервов для лучшего прогноза очевидно. Будем работать!
